@tailwind base;
@tailwind components;
@tailwind utilities;

/* ============================================================
   CSS Custom Properties — Dark theme (default)
   Values are space-separated R G B for Tailwind alpha support
   ============================================================ */
:root {
  --c-bg-primary: 49 51 56;
  --c-bg-secondary: 43 45 49;
  --c-bg-tertiary: 30 31 34;
  --c-bg-floating: 17 18 20;
  --c-bg-input: 30 31 34;
  --c-text-normal: 219 222 225;
  --c-text-header: 242 243 245;
  --c-text-muted: 148 155 164;
  --c-text-link: 0 168 252;
  --c-interactive-normal: 181 186 193;
  --c-interactive-hover: 219 222 225;
  --c-interactive-muted: 78 80 88;
  --c-brand: 88 101 242;
  --c-brand-dark: 71 82 196;
}

/* Light theme */
html[data-theme="light"] {
  --c-bg-primary: 242 243 245;
  --c-bg-secondary: 235 237 239;
  --c-bg-tertiary: 227 229 232;
  --c-bg-floating: 255 255 255;
  --c-bg-input: 227 229 232;
  --c-text-normal: 30 31 34;
  --c-text-header: 6 6 7;
  --c-text-muted: 99 102 110;
  --c-text-link: 0 86 204;
  --c-interactive-normal: 79 84 92;
  --c-interactive-hover: 6 6 7;
  --c-interactive-muted: 188 192 200;
  --c-brand: 88 101 242;
  --c-brand-dark: 71 82 196;
}

/* Amoled theme — pure blacks for OLED screens */
html[data-theme="amoled"] {
  --c-bg-primary: 0 0 0;
  --c-bg-secondary: 10 10 10;
  --c-bg-tertiary: 5 5 5;
  --c-bg-floating: 18 18 18;
  --c-bg-input: 5 5 5;
  --c-text-normal: 219 222 225;
  --c-text-header: 242 243 245;
  --c-text-muted: 148 155 164;
  --c-text-link: 0 168 252;
  --c-interactive-normal: 181 186 193;
  --c-interactive-hover: 219 222 225;
  --c-interactive-muted: 78 80 88;
  --c-brand: 88 101 242;
  --c-brand-dark: 71 82 196;
}

@layer base {
  * { box-sizing: border-box; }
  html, body, #root { height: 100%; margin: 0; padding: 0; }
  body {
    background-color: rgb(var(--c-bg-primary));
    color: rgb(var(--c-text-normal));
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
    font-size: 16px;
    line-height: 1.5;
    overflow: hidden;
    -webkit-font-smoothing: antialiased;
    transition: background-color 0.2s ease, color 0.2s ease;
  }
  ::-webkit-scrollbar { width: 8px; height: 8px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: rgb(var(--c-bg-floating)); border-radius: 4px; border: 2px solid transparent; background-clip: content-box; }
  ::-webkit-scrollbar-thumb:hover { background: rgb(var(--c-interactive-muted)); background-clip: content-box; }
  ::selection { background: rgba(88, 101, 242, 0.4); }
}

@layer components {
  .message-content { @apply text-text-normal leading-relaxed; word-wrap: break-word; white-space: pre-wrap; }
  .message-content p { margin: 0; }
  .message-content code { @apply bg-bg-floating text-orange-300 font-mono text-sm px-1 py-0.5 rounded; }
  .message-content pre { @apply bg-bg-floating rounded-md p-3 my-1 overflow-x-auto; font-family: 'Courier New', monospace; font-size: 0.875rem; white-space: pre; }
  .message-content pre code { @apply bg-transparent p-0; color: inherit; }
  .message-content blockquote { @apply border-l-4 border-interactive-muted pl-3 my-1 text-text-muted; }
  .message-content strong { @apply font-bold text-text-header; }
  .message-content em { @apply italic; }
  .message-content del { @apply line-through; }
  .message-content a { @apply text-text-link hover:underline; }
  .message-content .spoiler { @apply bg-text-muted/30 text-transparent rounded cursor-pointer select-none transition-all duration-150; }
  .message-content .spoiler.revealed { @apply text-text-normal; background-color: rgb(var(--c-bg-floating) / 0.8); }
  .mention { @apply bg-brand/20 text-brand rounded px-0.5 cursor-pointer hover:bg-brand hover:text-white transition-colors; }
  .emoji-custom { @apply inline-block w-5 h-5 align-middle mx-0.5; }
  .system-message { @apply flex items-center gap-2 px-4 py-1 text-sm text-text-muted italic; }
  .unread-dot { @apply absolute -top-0.5 -right-0.5 w-3 h-3 bg-danger rounded-full border-2 border-bg-tertiary; }
  .unread-mention { @apply absolute -top-1 -right-1 min-w-[18px] h-[18px] bg-danger text-white text-[10px] font-bold rounded-full flex items-center justify-center px-1 leading-none border-2 border-bg-tertiary; }
}

/* ============================================================
   Highlight.js — GitHub Dark syntax theme
   ============================================================ */
.hljs { color: #c9d1d9; background: transparent; }
.hljs-doctag, .hljs-keyword, .hljs-meta .hljs-keyword,
.hljs-template-tag, .hljs-template-variable,
.hljs-type, .hljs-variable.language_ { color: #ff7b72; }
.hljs-title, .hljs-title.class_, .hljs-title.class_.inherited__,
.hljs-title.function_ { color: #d2a8ff; }
.hljs-attr, .hljs-attribute, .hljs-literal, .hljs-meta,
.hljs-number, .hljs-operator, .hljs-variable,
.hljs-selector-attr, .hljs-selector-class, .hljs-selector-id { color: #79c0ff; }
.hljs-regexp, .hljs-string, .hljs-meta .hljs-string { color: #a5d6ff; }
.hljs-built_in, .hljs-symbol { color: #ffa657; }
.hljs-comment, .hljs-code, .hljs-formula { color: #8b949e; }
.hljs-name, .hljs-quote, .hljs-selector-tag, .hljs-selector-pseudo { color: #7ee787; }
.hljs-subst { color: #c9d1d9; }
.hljs-section { color: #1f6feb; font-weight: bold; }
.hljs-bullet { color: #f2cc60; }
.hljs-emphasis { color: #c9d1d9; font-style: italic; }
.hljs-strong { color: #c9d1d9; font-weight: bold; }
.hljs-addition { color: #aff5b4; background-color: #033a16; }
.hljs-deletion { color: #ffdcd7; background-color: #67060c; }

/* Light theme hljs overrides */
html[data-theme="light"] .hljs { color: #24292e; }
html[data-theme="light"] .hljs-keyword, html[data-theme="light"] .hljs-type { color: #d73a49; }
html[data-theme="light"] .hljs-title, html[data-theme="light"] .hljs-title.function_ { color: #6f42c1; }
html[data-theme="light"] .hljs-number, html[data-theme="light"] .hljs-literal { color: #005cc5; }
html[data-theme="light"] .hljs-string { color: #032f62; }
html[data-theme="light"] .hljs-comment { color: #6a737d; }
html[data-theme="light"] .hljs-name { color: #22863a; }
html[data-theme="light"] .hljs-built_in { color: #e36209; }
